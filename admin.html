<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Admin - Enviar E-mails</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #1a0033;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .login, .panel {
      background: #fff;
      color: #000;
      padding: 20px;
      border-radius: 10px;
      width: 100%;
      max-width: 500px;
      box-shadow: 0 0 12px #ff00ff;
    }
    h2 { text-align: center; }
    label { display: block; margin-top: 10px; }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    button {
      background: linear-gradient(45deg,#ff00ff,#8000ff);
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      border: none;
      margin-top: 15px;
    }
    button:hover { opacity: 0.9; }
    .hidden { display: none; }
  </style>
</head>
<body>

  <!-- Tela de login -->
  <div class="login" id="login-box">
    <h2>üîí Acesso Restrito</h2>
    <label for="password">Senha:</label>
    <input type="password" id="password">
    <button onclick="checkPassword()">Entrar</button>
    <p id="login-error" style="color:red; display:none; font-size:13px; margin-top:8px;">Senha incorreta.</p>
  </div>

  <!-- Painel -->
  <div class="panel hidden" id="admin-panel">
    <h2>üì© Enviar E-mail</h2>

    <label for="nome">Nome do Cliente</label>
    <input type="text" id="nome">

    <label for="email">E-mail do Cliente</label>
    <input type="email" id="email">

    <label for="telefone">Telefone</label>
    <input type="text" id="telefone">

    <label for="sessao">Sess√£o</label>
    <select id="sessao"></select>

    <label>Ingressos</label>
    <div style="display:flex; gap:10px;">
      <div style="flex:1;">
        <input type="number" id="inteira" min="0" value="0" placeholder="Inteiras">
      </div>
      <div style="flex:1;">
        <input type="number" id="meia" min="0" value="0" placeholder="Meias">
      </div>
    </div>

    <label for="tipo_email">Tipo de E-mail</label>
    <select id="tipo_email">
      <option value="pendente">‚ö†Ô∏è Pagamento Pendente</option>
      <option value="lembrete">‚è≥ Lembrete de Pagamento</option>
    </select>

    <button onclick="enviarEmail()">Enviar E-mail</button>
    <p id="status" style="margin-top:10px; font-weight:bold;"></p>
  </div>

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script>
    /***************
     CONFIGURA√á√ïES
    ***************/
    const ADMIN_PASSWORD = "2000admin"; 
    const EMAILJS_SERVICE_ID = "service_c9ak8yp";
    const TEMPLATE_PENDENTE = "template_5lax0jv";  
    const TEMPLATE_LEMBRETE = "template_w1t8lt8"; 
    const EMAILJS_PUBLIC_KEY = "zWI9wjgMNAHJ0WV7f";

    // Sess√µes dispon√≠veis
    const sessoes = [
      { id: "sessao-251003-2030", label: "03/10/2025 - 20h30" },
      { id: "sessao-251004-1730", label: "04/10/2025 - 17h30" },
      { id: "sessao-251004-2030", label: "04/10/2025 - 20h30" },
      { id: "sessao-251005-1730", label: "05/10/2025 - 17h30" },
      { id: "sessao-251005-2030", label: "05/10/2025 - 20h30" }
    ];

    // Links Mercado Pago
    const linksPagamento = {
      25:  "https://mpago.li/1SDJxrj",
      50:  "https://mpago.li/21ks87P",
      75:  "https://mpago.li/1VmFtmt",
      100: "https://mpago.li/2Lhv2M1",
      125: "https://mpago.li/1a688tD",
      150: "https://mpago.li/1uWW1XE",
      175: "https://mpago.li/2a2GAF5",
      200: "https://mpago.li/15tvMBA"
    };

    emailjs.init({ publicKey: EMAILJS_PUBLIC_KEY });

    /***************
     LOGIN
    ***************/
    function checkPassword() {
      const pass = document.getElementById("password").value;
      if(pass === ADMIN_PASSWORD) {
        document.getElementById("login-box").classList.add("hidden");
        document.getElementById("admin-panel").classList.remove("hidden");

        // Preenche sess√µes
        const sel = document.getElementById("sessao");
        sessoes.forEach(s => {
          const opt = document.createElement("option");
          opt.value = s.label;
          opt.textContent = s.label;
          sel.appendChild(opt);
        });
      } else {
        document.getElementById("login-error").style.display = "block";
      }
    }

    /***************
     ENVIO DE EMAIL
    ***************/
    async function enviarEmail() {
      const nome = document.getElementById("nome").value.trim();
      const email = document.getElementById("email").value.trim();
      const telefone = document.getElementById("telefone").value.trim();
      const sessao = document.getElementById("sessao").value;
      const inteiras = parseInt(document.getElementById("inteira").value || 0);
      const meias = parseInt(document.getElementById("meia").value || 0);
      const tipo_email = document.getElementById("tipo_email").value;

      const ingressos = `${inteiras} inteira(s), ${meias} meia(s)`;
      const total = (inteiras * 50) + (meias * 25);

      if(total === 0) {
        document.getElementById("status").textContent = "‚ùå Selecione pelo menos 1 ingresso.";
        document.getElementById("status").style.color = "red";
        return;
      }

      if(!linksPagamento[total]) {
        document.getElementById("status").textContent = "‚ùå Valor n√£o suportado (m√°ximo R$200).";
        document.getElementById("status").style.color = "red";
        return;
      }

      const payload = {
        from_name: nome,
        from_email: email,
        phone: telefone || "‚Äî",
        sessao: sessao,
        ingressos: ingressos,
        valor: total,
        link_pagamento: linksPagamento[total]
      };

      const templateID = (tipo_email === "pendente") ? TEMPLATE_PENDENTE : TEMPLATE_LEMBRETE;

      try {
        await emailjs.send(EMAILJS_SERVICE_ID, templateID, payload);
        document.getElementById("status").textContent = "‚úÖ E-mail enviado com sucesso!";
        document.getElementById("status").style.color = "green";
      } catch (err) {
        document.getElementById("status").textContent = "‚ùå Erro: " + JSON.stringify(err);
        document.getElementById("status").style.color = "red";
      }
    }
  </script>
</body>
</html>

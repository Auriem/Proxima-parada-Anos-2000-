<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Próxima Parada: Anos 2000 - Ingressos</title>

  <!-- Fontes -->
  <link href="https://fonts.googleapis.com/css2?family=VT323&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary-blue:#0000CD;
      --primary-purple:#8A2BE2;
      --neon-pink:#FF6EC7;
      --hot-pink:#FF1493;
      --neon-green:#ADFF2F;
      --white:#FFFFFF;
      --light-gray:#DDDDDD;
      --dark-gray:#222;
      --bg-grad: linear-gradient(135deg, var(--primary-blue), var(--primary-purple));
    }

    *{ box-sizing: border-box; margin:0; padding:0; }
    html,body{ height:100%; }
    body{
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      background: var(--bg-grad);
      color: var(--white);
      line-height: 1.55;
      background-attachment: fixed;
      overflow-x: hidden;
      position: relative;
      padding-top: 56px; /* espaço para ticker */
    }

    /* Scanlines / ruído leve */
    body::before{
      content:'';
      position: fixed; inset: 0;
      pointer-events: none; z-index: 1;
      background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255,255,255,0.03) 2px, rgba(255,255,255,0.03) 4px);
      animation: scanlines 2s linear infinite;
    }
    @keyframes scanlines{ 0%{transform:translateY(0)}100%{transform:translateY(4px)} }

    /* Partículas */
    #particles-container{ position: fixed; inset:0; pointer-events:none; z-index:2; }
    .particle{ position:absolute; width:2px; height:2px; background:var(--neon-pink); border-radius:50%; opacity:.6; animation: float 6s infinite linear; }
    @keyframes float{
      0%{ transform: translateY(100vh) translateX(0); opacity:0 }
      10%,90%{ opacity:.6 }
      100%{ transform: translateY(-10px) translateX(100px); opacity:0 }
    }

    .container{ width: 92%; max-width: 1100px; margin: 0 auto; padding: 20px; position: relative; z-index: 10; }

    header{
      text-align:center; padding:22px 0; border-bottom:3px solid var(--neon-pink);
      background: rgba(0,0,0,0.55); box-shadow: 0 0 18px var(--neon-pink);
      position: relative; overflow: hidden;
    }
    .logo{
      font-family: 'VT323', monospace;
      font-size: clamp(36px, 5vw, 64px);
      letter-spacing: 1px;
      margin: 0;
      -webkit-font-smoothing: antialiased;
      text-shadow: 0 0 5px #fff, 0 0 15px var(--neon-pink), 0 0 30px var(--neon-pink);
      animation: shine 2s infinite alternate;
    }
    @keyframes shine{
      0%{ text-shadow: 0 0 4px #fff, 0 0 10px var(--neon-pink) }
      100%{ text-shadow: 0 0 8px #fff, 0 0 20px var(--neon-pink), 0 0 40px var(--neon-green) }
    }

    /* TICKER / FAIXA ANIMADA */
    .ticker{
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: var(--hot-pink);
      color: #fff;
      font-weight: 800;
      font-size: 18px;
      padding: 8px 0;
      overflow: hidden;
      z-index: 2000;
      box-shadow: 0 0 10px var(--neon-pink);
      text-align:center;
    }
    .ticker span{
      display: inline-block;
      white-space: nowrap;
      padding-right: 100%;
      animation: tickerMove 12s linear infinite;
    }
    @keyframes tickerMove {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }

    /* Nav */
    nav{ margin: 18px 0; display:flex; gap:12px; justify-content:center; flex-wrap:wrap; z-index:11; position:relative; }
    .nav-button{
      background: linear-gradient(180deg, #3a3a3a, #1e1e1e);
      color: #fff; border: 2px solid #cfcfcf; border-radius: 10px;
      padding: 10px 18px; font-weight:700; cursor:pointer; text-decoration:none;
      display:inline-flex; align-items:center; gap:10px;
      box-shadow: 2px 2px 6px rgba(0,0,0,.4); transition: .2s;
      position:relative; overflow:hidden;
    }
    .nav-button .arrow{
      font-family:'VT323', monospace; font-size:20px; line-height:1;
      background: linear-gradient(90deg, #fff, #ff9de3, #7aff3a);
      -webkit-background-clip: text; background-clip: text; color: transparent;
      filter: drop-shadow(0 0 6px rgba(255,110,199,.8));
    }
    .nav-button:hover{ transform: translateY(-3px); box-shadow:0 8px 18px rgba(0,0,0,.35); }
    .nav-button:active{ transform: translateY(0); }

    .main-banner{
      background: rgba(0,0,0,.5); border:3px solid var(--neon-green); border-radius:16px; padding:22px; margin:28px 0; text-align:center;
      box-shadow: 0 0 22px var(--neon-green); position:relative; overflow:hidden;
    }
    .main-banner h2{ margin: 0 0 8px 0 }
    .action-button{
      background: linear-gradient(180deg, var(--neon-pink), var(--hot-pink));
      color:#fff; border:none; border-radius:12px; padding:12px 22px; font-size:18px; font-weight:800; cursor:pointer; margin-top:10px;
      box-shadow:0 0 14px var(--neon-pink); transition:.25s; display:inline-flex; align-items:center; gap:10px; text-decoration:none;
    }
    .action-button:hover{ transform: translateY(-4px); box-shadow: 0 10px 24px rgba(255,20,147,.45); }

    /* Countdown */
    .countdown{ background: rgba(0,0,0,.7); border:2px solid var(--hot-pink); border-radius:12px; padding:16px; margin:26px 0; text-align:center; box-shadow:0 0 16px var(--hot-pink); }
    .countdown-title{ font-family:'VT323', monospace; font-size:26px; color:var(--hot-pink); margin:0 0 10px 0 }
    .countdown-timer{ display:flex; justify-content:center; gap:14px; flex-wrap:wrap; }
    .countdown-box{ background:#111; border:1px solid #bbb; border-radius:8px; padding:10px 12px; min-width:62px }
    .countdown-number{ font-size:28px; font-weight:800; color:var(--neon-pink) }
    .countdown-label{ font-size:12px; color:#cfcfcf; letter-spacing:.04em }

    /* Events */
    .events-section{ margin: 38px 0 }
    .section-title{
      font-family:'VT323', monospace; font-size:34px; text-align:center; color:var(--neon-green);
      display:block; margin: 0 auto 10px auto;
    }
    .capacity-note{ text-align:center; color:#e9e9e9; opacity:.9; margin: 0 0 20px 0 }
    .events-list{ display:grid; grid-template-columns: repeat(auto-fill, minmax(300px,1fr)); gap:18px; }
    .event-card{
      background: rgba(0,0,0,.66); border:2px solid var(--neon-green); border-radius:12px; padding:18px; box-shadow:0 0 12px rgba(0,0,0,.5);
      transition:.35s;
    }
    .event-card:hover{ transform: translateY(-6px); border-color: var(--neon-pink); box-shadow:0 16px 30px rgba(0,0,0,.45); }
    .event-title{ font-size:22px; color:var(--neon-green); margin:0 0 6px 0 }
    .event-date, .event-price{ margin: 6px 0; color:#e8e8e8 }
    .event-button{
      margin-top:10px; width:100%;
      background: linear-gradient(180deg, var(--neon-green), #8aff00);
      color:#222; border:none; border-radius:10px; padding:10px 14px; font-weight:800; cursor:pointer; box-shadow:0 0 8px var(--neon-green);
      transition:.25s;
    }
    .event-button:hover{ transform: translateY(-2px) }
    .event-button:disabled{ background:#555; color:#999; cursor:not-allowed; box-shadow:none }

    /* About (cartaz + sinopse) */
    .about-section{ margin: 44px 0 }
    .about-content{
      display:grid; grid-template-columns: 1.2fr 1fr; gap: 24px; align-items:center;
      background: rgba(0,0,0,.45); border:2px solid #ffffff22; border-radius:16px; padding:20px;
    }
    .about-text{ text-align:left }
    .highlight-box{
      margin-top:12px; padding:16px;
      background: #ffffffee; color:#222; border-radius:12px;
      border: 3px dashed var(--hot-pink);
      box-shadow: 0 0 18px #ff69b4aa;
      font-size: 15.5px;
    }
    .about-image-container{ text-align:center }
    .about-image-container img{
      max-width: 380px; width:100%;
      border:4px solid var(--neon-pink); border-radius:14px; box-shadow:0 0 16px var(--neon-pink);
    }

    /* Location */
    .location-section{ margin: 30px 0; text-align:center }
    .location-address{ font-weight:600 }

    /* Cast */
    .cast-section{ margin: 44px 0 }
    .cast-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(160px,1fr)); gap:18px; }
    .cast-card{ background: rgba(0,0,0,.66); border:2px solid var(--neon-pink); border-radius:12px; padding:18px; text-align:center; transition:.3s }
    .cast-card:hover{ transform: translateY(-6px); border-color:var(--neon-green) }
    .cast-photo{ width:120px; height:120px; border-radius:50%; object-fit:cover; border:3px solid var(--neon-pink); box-shadow:0 0 12px rgba(255,110,199,.6) }

    /* Scrap */
    .scrap-section{ background: rgba(0,0,0,.5); border:3px solid var(--hot-pink); border-radius:16px; padding:20px; margin:36px 0; text-align:center; box-shadow:0 0 20px var(--hot-pink) }
    .scrap-input{ width:100%; max-width:420px; padding:10px; border:2px solid var(--neon-pink); border-radius:8px; background: rgba(0,0,0,.7); color:#fff; font-size:16px; }
    .retro-loader{ display:none; color:var(--neon-pink); margin-top:10px }
    .retro-loader.active{ display:block }
    .scrap-result{ background: rgba(0,0,0,.8); border:1px solid #ccc; border-radius:8px; padding:14px; margin-top:12px; white-space:pre-wrap; text-align:left }

    /* Modal */
    .modal-overlay{ position:fixed; inset:0; background: rgba(0,0,0,.8); display:none; justify-content:center; align-items:center; z-index:1000; backdrop-filter: blur(5px) }
    .modal-content{
      background: var(--bg-grad); color:#fff; width:92%; max-width:600px; max-height:90vh; overflow-y:auto;
      border:3px solid var(--neon-pink); border-radius:16px; padding:20px; position:relative; box-shadow:0 0 28px var(--neon-pink);
      animation: modalAppear .25s ease-out;
    }
    @keyframes modalAppear{ from{transform:scale(.92); opacity:0} to{transform:scale(1); opacity:1} }
    .modal-close{ position:absolute; top:10px; right:12px; background:none; border:none; color:#fff; font-size:26px; cursor:pointer }
    .modal-title{ font-family:'VT323', monospace; font-size:30px; color:var(--neon-pink); margin:6px 0 16px 0; text-align:center }
    .form-group{ margin-bottom:14px }
    .form-group label{ display:block; font-weight:700; margin-bottom:6px }
    .form-group input, .form-group select{
      width:100%; padding:12px; border:2px solid var(--neon-green); border-radius:10px; background: rgba(0,0,0,.65); color:#fff; font-size:16px;
    }
    .form-row{ display:flex; gap:14px }
    .form-row .form-group{ flex:1 }

    .continue-button{
      background: linear-gradient(180deg, var(--neon-green), #8aff00);
      color:#222; border:none; border-radius:12px; padding:14px 18px; font-weight:800; cursor:pointer; width:100%;
      box-shadow:0 0 12px var(--neon-green); transition:.22s;
    }
    .continue-button:hover{ transform: translateY(-3px) }

    .payment-section{ display:none; margin-top:16px; padding-top:16px; border-top:2px solid var(--neon-pink) }

    #final-status-screen{ display:none; text-align:center; padding:12px }
    #final-status-screen img{ max-width:280px; border:4px solid var(--neon-pink); border-radius:12px; margin:10px auto 12px; display:block }
    .retro-code{ font-family:'VT323', monospace; font-size:22px; color:var(--neon-green); background:#111; padding:10px 14px; border-radius:8px; display:inline-block; letter-spacing:1px }

    .tag-pendente{
      display:inline-block; font-weight:800; letter-spacing:.02em;
      padding:5px 10px; border-radius:999px; background:#111; border:2px dashed var(--hot-pink); color:var(--hot-pink);
      margin: 6px 0 12px 0;
    }

    footer{ text-align:center; padding:24px 0; background: rgba(0,0,0,.5); margin-top:32px; border-top:3px solid #ffffff33 }

    @media (max-width: 900px){
      .about-content{ grid-template-columns: 1fr; text-align:left }
      .about-image-container{ order:-1 }
      .ticker{ font-size:14px; }
    }

    /* pequenos estilos para campos de convidados */
    .convidado-row{ display:flex; gap:10px; margin-bottom:8px; align-items:center; }
    .convidado-row input { flex:1; }
    .convidado-note { font-size:13px; opacity:.9; margin-bottom:8px; color:#ffd6f0; }
  </style>
</head>
<body>
  <!-- Ticker / Faixa fixa -->
  <div class="ticker" id="global-ticker"><span>🚨 Garanta seu ingresso! Não mosca senão acaba! 🚨</span></div>

  <!-- Partículas -->
  <div id="particles-container"></div>

  <div class="container">
    <header>
      <h1 class="logo">Próxima Parada: Anos 2000</h1>
    </header>

    <nav>
      <a href="#eventos" class="nav-button"><span class="arrow">➤</span> Ingressos</a>
      <a href="#sobre" class="nav-button"><span class="arrow">➤</span> Sobre</a>
      <a href="#elenco" class="nav-button"><span class="arrow">➤</span> Elenco</a>
      <a href="#scrap" class="nav-button"><span class="arrow">➤</span> Scrap</a>
    </nav>

    <div class="main-banner">
      <h2>Uma viagem nostálgica pelos anos 2000!</h2>
      <p>MSN, Orkut, lan house e muito glitter. Vem com a gente! ✨</p>
      <a href="#eventos" class="action-button">🎟️ COMPRAR INGRESSOS</a>
    </div>

    <div class="countdown">
      <div class="countdown-title">Próxima Apresentação</div>
      <div class="countdown-timer" id="countdown-timer">
        <div class="countdown-box"><div class="countdown-number" id="days">00</div><div class="countdown-label">DIAS</div></div>
        <div class="countdown-box"><div class="countdown-number" id="hours">00</div><div class="countdown-label">HORAS</div></div>
        <div class="countdown-box"><div class="countdown-number" id="minutes">00</div><div class="countdown-label">MIN</div></div>
        <div class="countdown-box"><div class="countdown-number" id="seconds">00</div><div class="countdown-label">SEG</div></div>
      </div>
    </div>

    <section id="eventos" class="events-section">
      <h2 class="section-title">Sessões Disponíveis</h2>
      <p class="capacity-note">Capacidade: 110 lugares por sessão</p>
      <div class="events-list" id="events-list-container"><!-- render dinâmico --></div>
    </section>

    <section id="sobre" class="about-section">
      <h2 class="section-title">Sobre a Peça</h2>
      <div class="about-content">
        <div class="about-text">
          <p>“Próxima Parada: Anos 2000” é uma comédia afetuosa que mistura humor, memória e crítica. Em meio a pôsteres colados com durex, conversas no MSN e bandas escolares, um grupo vive os dias em que o tempo parecia infinito — até que uma visitante do futuro chega para “atualizar o sistema”.</p>
          <div class="highlight-box">
            Entre trotes telefônicos e debates existenciais, o espetáculo questiona como a tecnologia transformou nossas relações. É um retrato de uma geração que aprendeu a amar offline e a lidar com o mundo a 256 kbps.
          </div>
        </div>
        <div class="about-image-container">
          <img src="https://i.postimg.cc/yYW55Cxh/material-pe-a.png" alt="Pôster da Peça">
        </div>
      </div>
    </section>

    <section id="local" class="location-section">
      <h3 class="section-title">📍 Local de Apresentação 📍</h3>
      <p class="location-address">Teatro Enio Carvalho - Rua Mateus Leme, 990, Centro Cívico, Curitiba</p>
    </section>

    <section id="elenco" class="cast-section">
      <h2 class="section-title">Nosso Elenco</h2>
      <div class="cast-grid" id="cast-grid-container"><!-- render dinâmico --></div>
    </section>

    <section id="scrap" class="scrap-section">
      <h2 class="section-title">Gerador de Scrap Nostálgico</h2>
      <p>Crie uma mensagem nostálgica personalizada sobre os anos 2000!</p>
      <input type="text" id="scrap-input" class="scrap-input" placeholder="Digite aqui: anos 2000">
      <button id="scrap-button" class="action-button">✨ Gerar Scrap!</button>
      <div class="retro-loader" id="scrap-loading">Gerando sua nostalgia...</div>
      <div id="scrap-result" class="scrap-result"></div>
    </section>

    <footer id="contato">
      <div class="container">
        <img src="https://i.postimg.cc/H8phbYvx/ce6dae6d-822a-4f90-9415-f73e5ac34390.png" alt="Logo Auriem Produções" style="width: 100px; margin-bottom: 15px;">
        <h3>Fale Conosco ::: Mande um Scrap!</h3>
        <p>Dúvidas, sugestões ou só quer mandar um "Oi!"? Entre em contato!</p>
        <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:center;">
          <a href="mailto:auriemcompany@gmail.com" class="action-button">Enviar E-mail 📧</a>
          <a href="https://wa.me/5541985031409" target="_blank" class="action-button">Chama no Zap 📱</a>
          <a href="https://www.instagram.com/auriem_company/" target="_blank" class="action-button">Instagram 📸</a>
          <a href="https://www.youtube.com/@auriemcompany" target="_blank" class="action-button">YouTube 🎥</a>
          <a href="https://www.tiktok.com/@auriemcompany" target="_blank" class="action-button">TikTok 🎵</a>
        </div>
        <p style="opacity:.9">2025 Auriem Produções Artísticas. Todos os direitos reservados.</p>
      </div>
    </footer>
  </div>

  <!-- Modal de Compra -->
  <div id="purchase-modal" class="modal-overlay">
    <div class="modal-content">
      <button id="modal-close-btn" class="modal-close">×</button>
      <h3 class="modal-title">Comprar Ingresso</h3>

      <!-- Etapa 1: Dados + Quantidades -->
      <div id="personal-data-form">
        <div class="form-group"><label for="full-name">Nome Completo *</label><input type="text" id="full-name" required></div>
        <div class="form-group"><label for="email">E-mail *</label><input type="email" id="email" required></div>
        <div class="form-group"><label for="phone">Telefone</label><input type="tel" id="phone"></div>

        <div class="form-group">
          <label>Tipo de Ingresso</label>
          <div class="form-row">
            <div class="form-group"><label for="qty-inteira">Inteira (R$ 50,00)</label><input type="number" id="qty-inteira" min="0" value="1" max="8"></div>
            <div class="form-group"><label for="qty-meia">Meia (R$ 25,00)</label><input type="number" id="qty-meia" min="0" value="0" max="8"></div>
          </div>
        </div>

        <div id="session-picked" style="font-size:14px;opacity:.85;margin:6px 0 0 0;"></div>

        <div style="display:flex; justify-content:space-between; align-items:center; margin:8px 0 4px 0">
          <strong>Total:</strong>
          <div class="retro-code" id="total-amount">R$ 50,00</div>
        </div>
        <button id="continue-to-payment" class="continue-button">Avançar</button>
        <p style="font-size:12px; opacity:.85; margin-top:8px;">Limite: 8 ingressos por compra • Gere seu ingresso e EFETUE O PAGAMENTO LOGO EM SEGUIDA. Seu ingresso único aparecerá na tela e será enviado por email. (status <b>PENDENTE</b> até confirmarmos).</p>
      </div>

      <!-- Etapa 2: Geração do ingresso + pagamento -->
      <div id="post-payment-section" class="payment-section" style="display:none;">
        <span class="tag-pendente">STATUS: PENDENTE DE VALIDAÇÃO</span>
        <p style="margin-bottom:10px;">Seu ingresso será gerado e enviado por e-mail. O pagamento deve ser feito em seguida.</p>

        <!-- ADICIONADO: Área de convidados (preenchimento opcional / recomendado) -->
        <div id="convidadosContainer" style="margin-bottom:12px;">
          <!-- campos serão inseridos dinamicamente -->
        </div>

        <div class="form-group">
          <label for="responsavel-pix">Nome do responsável pelo pagamento (obrigatório)</label>
          <input type="text" id="responsavel-pix" placeholder="Ex.: Fulano de Tal">
        </div>

        <div class="form-row" style="align-items:flex-end;">
          <div class="form-group" style="flex:1;"><button id="send-ticket-btn" class="continue-button">🪄 Gerar e enviar meu ingresso</button></div>
        </div>

        <div style="margin:12px 0; text-align:center; font-size:12px; opacity:.85;">Depois de gerar, efetue o pagamento para validar seu ingresso :</div>

        <div class="form-row">
          <div class="form-group"><button id="pay-mp-btn" class="continue-button">💳 Efetuar pagamento</button></div>
        </div>

        <div id="sending-loader" class="retro-loader">Enviando dados...</div>
      </div>

      <!-- Etapa Final (mostra ingresso pro cliente) -->
      <div id="final-status-screen"></div>
    </div>
  </div>

  <!-- UI Sound -->
  <audio id="ui-click" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>

  <!-- EmailJS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

  <script>
    /***********************
     CONFIGURAÇÕES (EMAILJS + CONSTANTES)
    ***********************/
    const OWNER_EMAIL = "proximaparada.anos2000@gmail.com";

    const EMAILJS_SERVICE_ID    = "service_92u9mqw";
    const EMAILJS_PUBLIC_KEY    = "Nk9hiz7JjoCFGkh-G";
    const EMAILJS_TEMPLATE_ADMIN  = "template_q6bkd4d";     // seu template de admin
    const EMAILJS_TEMPLATE_CLIENT = "template_7vw4axk";    // template cliente (usar {{to_email}} no campo To)

    // URL da página de confirmação (coloque sua página do GitHub/Netlify aqui)
    const CONFIRMATION_PAGE_URL = "https://proximaparadaanos2000.netlify.app/confirmacao.html"; // <-- ajuste conforme necessário

    // Links Mercado Pago (valores pré-definidos)
    const linksPagamento = {
      25:  "https://mpago.li/1SDJxrj",
      50:  "https://mpago.li/21ks87P",
      75:  "https://mpago.li/1VmFtmt",
      100: "https://mpago.li/2Lhv2M1",
      125: "https://mpago.li/1a688tD",
      150: "https://mpago.li/1uWW1XE",
      175: "https://mpago.li/2a2GAF5",
      200: "https://mpago.li/15tvMBA"
    };

    // SESSÕES
    const sessoes = [
      { id: 'sessao-251003-2030', data: '2025-10-03T20:30:00', precoInteira: 50.00, precoMeia: 25.00, esgotado: false },
      { id: 'sessao-251004-1730', data: '2025-10-04T17:30:00', precoInteira: 50.00, precoMeia: 25.00, esgotado: false },
      { id: 'sessao-251004-2030', data: '2025-10-04T20:30:00', precoInteira: 50.00, precoMeia: 25.00, esgotado: false },
      { id: 'sessao-251005-1730', data: '2025-10-05T17:30:00', precoInteira: 50.00, precoMeia: 25.00, esgotado: false },
      { id: 'sessao-251005-2030', data: '2025-10-05T20:30:00', precoInteira: 50.00, precoMeia: 25.00, esgotado: false },
    ];

    const elenco = [
      { nome: 'Antônia Montemezzo', personagem: 'Juliana', foto: 'https://i.postimg.cc/x8HYSWpL/Ant-nia-Montemezzo.jpg' },
      { nome: 'Evelyn Muller', personagem: 'Luana', foto: 'https://i.postimg.cc/9XqcT7Xz/Evelyn-Muller.jpg' },
      { nome: 'Carolina Ribas', personagem: 'Raquel', foto: 'https://i.postimg.cc/Pxvnmgj0/IMG-0898.jpg' },
      { nome: 'Jessica Nayara', personagem: 'Sofia', foto: 'https://i.postimg.cc/qq8fF2gL/Jessica-Nayara.jpg' },
      { nome: 'Aquiles Amendola', personagem: 'Fernando', foto: 'https://i.postimg.cc/Vksy7rwq/Aquiles-Amendola.jpg' },
      { nome: 'Anthony Braga', personagem: 'Bruno', foto: 'https://i.postimg.cc/SQcwk7NL/IMG-1979.jpg' },
      { nome: 'Pedro Ferraz', personagem: 'Marcelo', foto: 'https://i.postimg.cc/66V1DWYY/Pedro-Ferraz.jpg' },
    ];

    /***********************
     INICIALIZAÇÃO
    ***********************/
    emailjs.init(EMAILJS_PUBLIC_KEY);

    // DOM elements
    const uiClick = document.getElementById('ui-click');
    const modal = document.getElementById('purchase-modal');
    const closeBtn = document.getElementById('modal-close-btn');
    const continueBtn = document.getElementById('continue-to-payment');
    const personalDataForm = document.getElementById('personal-data-form');
    const postPaymentSection = document.getElementById('post-payment-section');
    const sendTicketBtn = document.getElementById('send-ticket-btn');
    const payMpBtn = document.getElementById('pay-mp-btn');
    const sendingLoader = document.getElementById('sending-loader');
    const finalStatusScreen = document.getElementById('final-status-screen');
    const qtyInteira = document.getElementById('qty-inteira');
    const qtyMeia = document.getElementById('qty-meia');
    const totalAmountDiv = document.getElementById('total-amount');
    const sessionPickedDiv = document.getElementById('session-picked');
    const convidadosContainer = document.getElementById('convidadosContainer');

    let selectedSession = null;
    let generatedCode = null;

    function playClick(){ try{ uiClick.currentTime = 0; uiClick.play(); }catch(e){} }

    /***********************
     RENDER
    ***********************/
    function createParticles(){
      const container = document.getElementById('particles-container');
      const count = 50;
      for(let i=0;i<count;i++){
        const p = document.createElement('div');
        p.className = 'particle';
        p.style.left = Math.random()*100 + '%';
        p.style.animationDelay = Math.random()*6 + 's';
        p.style.animationDuration = (Math.random()*3 + 3) + 's';
        container.appendChild(p);
      }
    }

    function renderContent(){
      const eventsContainer = document.getElementById('events-list-container');
      eventsContainer.innerHTML = '';
      sessoes.forEach(sessao=>{
        const d = new Date(sessao.data);
        const dia = d.toLocaleDateString('pt-BR', { weekday:'long' });
        const dataF = d.toLocaleDateString('pt-BR', { day:'2-digit', month:'2-digit' });
        const horaF = d.toLocaleTimeString('pt-BR', { hour:'2-digit', minute:'2-digit' });

        const card = document.createElement('div');
        card.className = 'event-card';
        card.innerHTML = `
          <h3 class="event-title">${dia.charAt(0).toUpperCase()+dia.slice(1)}, ${dataF}</h3>
          <p class="event-date">${horaF}h</p>
          <p class="event-price">A partir de R$ ${sessao.precoMeia.toFixed(2).replace('.',',')}</p>
          <button class="event-button" data-session-id="${sessao.id}" ${sessao.esgotado?'disabled':''}>
            ${sessao.esgotado?'ESGOTADO':'COMPRAR INGRESSO'}
          </button>`;
        eventsContainer.appendChild(card);
      });

      // Elenco
      const castContainer = document.getElementById('cast-grid-container');
      castContainer.innerHTML = '';
      elenco.forEach(m=>{
        const card = document.createElement('div');
        card.className = 'cast-card';
        card.innerHTML = `
          <img src="${m.foto}" class="cast-photo" alt="${m.nome}">
          <h3 style="margin:10px 0 4px 0">${m.nome}</h3>
          <p style="opacity:.9">${m.personagem}</p>
        `;
        castContainer.appendChild(card);
      });
      const gif = document.createElement('div');
      gif.className = 'cast-card';
      gif.innerHTML = `<img src="https://i.postimg.cc/g2pMsfv1/original-720d9864401760525b4ddf084f3dc161.gif" alt="TV Retrô" style="width:120px; height:120px; border-radius:10px; border:3px solid var(--neon-pink);">`;
      castContainer.appendChild(gif);
    }

    function updateCountdown(){
      const next = sessoes.find(s => new Date(s.data) > new Date());
      if(!next) return;
      const target = new Date(next.data);
      const now = new Date();
      const diff = target - now;
      if(diff <= 0) return;
      const d = Math.floor(diff / (1000*60*60*24));
      const h = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
      const m = Math.floor((diff % (1000*60*60)) / (1000*60));
      const s = Math.floor((diff % (1000*60)) / 1000);
      document.getElementById('days').textContent = String(d).padStart(2,'0');
      document.getElementById('hours').textContent = String(h).padStart(2,'0');
      document.getElementById('minutes').textContent = String(m).padStart(2,'0');
      document.getElementById('seconds').textContent = String(s).padStart(2,'0');
    }

    /***********************
     UTIL
    ***********************/
    function openModal(sessionId){
      selectedSession = sessoes.find(s=>s.id===sessionId);
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
      personalDataForm.style.display = 'block';
      postPaymentSection.style.display = 'none';
      finalStatusScreen.style.display = 'none';
      generatedCode = null;
      updateTotalAmount();
      renderSessionPicked();
      // garantir campos de convidados atualizados caso usuário abra direto
      renderGuestFieldsInPostPayment();
    }
    function closeModal(){
      modal.style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    function renderSessionPicked(){
      if(!selectedSession){ sessionPickedDiv.textContent=''; return; }
      const d = new Date(selectedSession.data);
      const dataF = d.toLocaleDateString('pt-BR', { day:'2-digit', month:'2-digit', year:'numeric' });
      const horaF = d.toLocaleTimeString('pt-BR', { hour:'2-digit', minute:'2-digit' });
      sessionPickedDiv.innerHTML = `Sessão selecionada: <b>${dataF} • ${horaF}h</b>`;
    }

    function updateTotalAmount(){
      if(!selectedSession) return;
      const qI = parseInt(qtyInteira.value||'0');
      const qM = parseInt(qtyMeia.value||'0');
      const total = (qI * selectedSession.precoInteira) + (qM * selectedSession.precoMeia);
      totalAmountDiv.textContent = `R$ ${total.toFixed(2).replace('.',',')}`;
    }

    function validateForm(){
      let ok = true;
      const name = document.getElementById('full-name');
      const email = document.getElementById('email');
      if(!name.value.trim()){ name.style.borderColor='red'; ok=false } else name.style.borderColor='';
      if(!email.value.trim()){ email.style.borderColor='red'; ok=false } else email.style.borderColor='';
      const totalTickets = (parseInt(qtyInteira.value||'0') + parseInt(qtyMeia.value||'0'));
      if(totalTickets===0){ alert('Você precisa selecionar pelo menos um ingresso.'); ok=false; }
      if(totalTickets>8){ alert('A compra é limitada a 8 ingressos por vez.'); ok=false; }
      if(!ok) alert('Por favor, preencha os campos obrigatórios e verifique as quantidades.');
      return ok;
    }

    function calcularTotalNumero(){
      const parsed = parseFloat(totalAmountDiv.textContent.replace('R$','').replace('.','').replace(',','.').trim());
      return Math.round(parsed);
    }

    function detalhesCompraString(){
      const qI = parseInt(qtyInteira.value||'0');
      const qM = parseInt(qtyMeia.value||'0');
      const tot = totalAmountDiv.textContent;
      const dataObj = new Date(selectedSession.data);
      const dataF = dataObj.toLocaleDateString('pt-BR',{day:'2-digit',month:'2-digit',year:'numeric'});
      const horaF = dataObj.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'});
      return `${qI} inteira(s), ${qM} meia(s) — Total ${tot} — Sessão ${dataF} ${horaF}h`;
    }

    function sessaoLegivel(sessId){
      const sess = sessoes.find(s=>s.id===sessId);
      if(!sess) return sessId;
      const d = new Date(sess.data);
      const dataF = d.toLocaleDateString('pt-BR',{day:'2-digit',month:'2-digit',year:'numeric'});
      const horaF = d.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'});
      return `${dataF} ${horaF}`;
    }

    function gerarCodigoUnico(sessaoId){
      const sess = sessoes.find(s=>s.id===sessaoId);
      const d = new Date(sess.data);
      const dia = String(d.getDate()).padStart(2,'0');
      const mes = String(d.getMonth()+1).padStart(2,'0');
      const hora = String(d.getHours()).padStart(2,'0');
      const min = String(d.getMinutes()).padStart(2,'0');
      const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      let rand=""; for(let i=0;i<5;i++) rand += chars.charAt(Math.floor(Math.random()*chars.length));
      return `PRX2000-${dia}${mes}-${hora}${min}-${rand}`;
    }

    function openPaymentLinkForTotal(total){
      const baseLink = linksPagamento[total];
      if(!baseLink){ alert('Valor não disponível. Ajuste as quantidades para um total válido (25 a 200).'); return false; }
      window.open(baseLink, '_blank');
      return true;
    }

    /***********************
     Convidados (render + coleta)
    ***********************/
    function renderGuestFieldsInPostPayment(){
      // popula #convidadosContainer com campos para (totalTickets - 1)
      convidadostmp = convidadosContainer;
      convidadostmp.innerHTML = ''; // limpa

      const totalTickets = (parseInt(qtyInteira.value||'0') + parseInt(qtyMeia.value||'0')) || 0;
      if(totalTickets <= 1){
        convidadostmp.innerHTML = `<div class="convidado-note">Você comprou <b>1</b> ingresso. Não é necessário preencher nomes de convidados.</div>`;
        return;
      }

      const need = Math.max(0, totalTickets - 1);
      convidadostmp.innerHTML = `<div class="convidado-note">Preencha os nomes dos ${need} convidados (opcional, mas recomendado). Se não souber, deixe em branco e poderá completar depois com a produção.</div>`;

      for(let i=1;i<=need;i++){
        const row = document.createElement('div');
        row.className = 'convidado-row';
        const input = document.createElement('input');
        input.type = 'text';
        input.placeholder = `Nome do convidado ${i}`;
        input.setAttribute('data-guest-index', i);
        input.name = `convidado_${i}`;
        row.appendChild(input);
        convidadostmp.appendChild(row);
      }
    }

    function collectGuestNames(){
      const arr = [];
      document.querySelectorAll('#convidadosContainer input[data-guest-index]').forEach(inp=>{
        const v = (inp.value||'').trim();
        if(v) arr.push(v);
      });
      return arr;
    }

    function savePurchaseToLocalStorage(obj){
      try{
        const key = `compra_${obj.code}`;
        localStorage.setItem(key, JSON.stringify(obj));
        // manter lista pendente
        const pending = JSON.parse(localStorage.getItem('compra_pending') || '[]');
        if(!pending.includes(key)) pending.push(key);
        localStorage.setItem('compra_pending', JSON.stringify(pending));
      }catch(e){
        console.warn('Não foi possível salvar localmente:', e);
      }
    }

    /***********************
     EVENTOS
    ***********************/
    closeBtn.addEventListener('click', ()=>{ playClick(); closeModal(); });
    document.getElementById('purchase-modal').addEventListener('click', (e)=>{
      if(e.target === document.getElementById('purchase-modal')) closeModal();
    });

    // atualizar total quando muda quantidade e atualizar convidados também
    qtyInteira.addEventListener('input', ()=>{ playClick(); updateTotalAmount(); renderGuestFieldsInPostPayment(); });
    qtyMeia.addEventListener('input', ()=>{ playClick(); updateTotalAmount(); renderGuestFieldsInPostPayment(); });

    continueBtn.addEventListener('click', ()=>{
      playClick();
      if(!validateForm()) return;
      personalDataForm.style.display='none';
      postPaymentSection.style.display='block';
      finalStatusScreen.style.display='none';
      // renderiza campos de convidados na etapa 2
      renderGuestFieldsInPostPayment();
    });

    // Gera ingresso + envia e-mail (adm + cliente)
    sendTicketBtn.addEventListener('click', async ()=> {
      playClick();

      // proibir clicks repetidos
      sendTicketBtn.disabled = true;
      sendingLoader.classList.add('active');

      const nome = document.getElementById('full-name').value.trim();
      const emailCliente = document.getElementById('email').value.trim();
      const telefone = document.getElementById('phone').value.trim() || '—';
      const respPix = document.getElementById('responsavel-pix').value.trim() || '—';
      const totalNumero = calcularTotalNumero();
      const linkPagamento = linksPagamento[totalNumero] || '';

      if(!nome || !emailCliente){
        alert('Preencha nome e e-mail.');
        sendTicketBtn.disabled = false;
        sendingLoader.classList.remove('active');
        return;
      }

      // gerar código
      generatedCode = gerarCodigoUnico(selectedSession.id);

      // coletar convidados (se tiverem)
      const convidados = collectGuestNames(); // array
      const convidadosStr = convidados.length ? convidados.join(' • ') : '—';

      const d = new Date(selectedSession.data);
      const sessaoStr = d.toLocaleDateString('pt-BR',{day:'2-digit',month:'2-digit',year:'numeric'}) + ' ' +
                        d.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'}) + 'h';

      // payload base para admin
      const adminPayload = {
        to_email: OWNER_EMAIL,
        from_name: nome,
        from_email: emailCliente,
        phone: telefone,
        responsavel_pix: respPix,
        sessao: selectedSession.id,
        sessao_legivel: sessaoLegivel(selectedSession.id),
        ingresso: detalhesCompraString(),
        code: generatedCode,
        total_value: totalAmountDiv.textContent.replace('R$','').trim(),
        nomes_convidados: convidadosStr,
        purchase_action: 'gerado_pendente',
        purchase_time: new Date().toISOString()
      };

      // payload para cliente
      const clientPayload = {
        to_email: emailCliente,                 // importante: no template cliente usar {{to_email}}
        reply_to: OWNER_EMAIL,
        nome_cliente: nome,
        codigo_ingresso: generatedCode,
        sessao_escolhida: sessaoStr,
        ingresso: detalhesCompraString(),
        valor_ingresso: totalAmountDiv.textContent.replace('R$','').trim(),
        link_pagamento: linkPagamento,
        suporte_email: OWNER_EMAIL,
        suporte_whatsapp: "5541985031409",
        nomes_convidados: convidadosStr,
        link_confirmacao: CONFIRMATION_PAGE_URL + '?email=' + encodeURIComponent(emailCliente) // opcional: link para completar dados
      };

      try{
        // envia para ADMIN
        await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ADMIN, adminPayload);

        // envia para CLIENTE (se template cliente existir)
        await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_CLIENT, clientPayload);

        // salva no localStorage (para referência / controle)
        savePurchaseToLocalStorage({
          code: generatedCode,
          nome,
          email: emailCliente,
          telefone,
          respPix,
          sessao: selectedSession.id,
          detalhes: detalhesCompraString(),
          nomes_convidados: convidados,
          total_value: totalAmountDiv.textContent.replace('R$','').trim(),
          timestamp: new Date().toISOString(),
          status: 'PENDENTE'
        });

        // UI: mostrar ingresso e manter opção de pagar
        finalStatusScreen.innerHTML = `
          <h2>✅ Ingresso gerado e enviado por e-mail!</h2>
          <div class="tag-pendente">STATUS: PENDENTE DE VALIDAÇÃO</div>
          <p>Guarde este código: caso não tenha recebido no email, TIRE PRINT DESTA TELA</p>
          <div class="retro-code">${generatedCode}</div>
          <p style="font-size:12px;opacity:.9;">Enviamos para: <b>${emailCliente}</b>. Se não achar, verifique Spam.</p>
          <div style="margin-top:14px;">
            <img src="https://i.postimg.cc/mky7jPYT/ingresso-digital.png" alt="Ingresso">
          </div>
          <div style="margin-top:12px; text-align:left; max-width:460px; margin-left:auto; margin-right:auto; background:rgba(0,0,0,.35); padding:12px; border-radius:8px;">
            <b>Resumo</b><br>
            Nome: ${nome}<br>
            E-mail: ${emailCliente}<br>
            Sessão: ${sessaoLegivel(selectedSession.id)}<br>
            Itens: ${detalhesCompraString()}<br>
            Convidados: ${convidadosStr}
          </div>
          <div style="margin-top:16px; display:flex; gap:10px; flex-wrap:wrap; justify-content:center;">
            <button id="pay-after-generated" class="continue-button" style="max-width:260px;">💳 Pagar pelo Mercado Pago</button>
            <button id="copy-summary" class="continue-button" style="max-width:260px;">📋 Copiar resumo</button>
          </div>
          <div style="margin-top:10px; font-size:12px; opacity:.9;">
            Você também recebeu esse e-mail. Após o pagamento, ele sera validado automaticamente.
          </div>
        `;
        finalStatusScreen.style.display='block';

        // reativa botão de pagamento no modal
        // pay-after-generated usará o total atual (calcular na hora que clicar)
        const payAfter = document.getElementById('pay-after-generated');
        if(payAfter){
          payAfter.addEventListener('click', ()=>{
            const totalNow = calcularTotalNumero();
            if(totalNow === 0){ alert('Selecione ao menos 1 ingresso.'); return; }
            if(!linksPagamento[totalNow]){ alert('Para este total não há link configurado. Ajuste as quantidades.'); return; }
            openPaymentLinkForTotal(totalNow);
          });
        }

        // copiar resumo
        const copyBtn = document.getElementById('copy-summary');
        if(copyBtn){
          copyBtn.addEventListener('click', ()=>{
            const resumo = `INGRESSO - Próxima Parada: Anos 2000
Código: ${generatedCode}
Nome: ${nome}
Sessão: ${sessaoLegivel(selectedSession.id)}
${detalhesCompraString()}
Convidados: ${convidadosStr}`;
            navigator.clipboard.writeText(resumo).then(()=>alert('Resumo copiado!'));
          });
        }

      }catch(err){
        console.error('Erro no envio por EmailJS:', err);
        finalStatusScreen.innerHTML = `
          <h2>⚠️ Ingresso gerado, mas houve erro ao enviar e-mail.</h2>
          <p><b>Tire um print desta tela com o código e salve, ele é seu ingresso digital.:</b></p>
          <div class="retro-code">${generatedCode}</div>
          <p style="font-size:12px;opacity:.9;">Se precisar, fale com a produção: <a href="mailto:${OWNER_EMAIL}">${OWNER_EMAIL}</a></p>
          <p style="font-size:11px;opacity:.7;margin-top:8px;">Detalhe técnico: ${JSON.stringify(err)}</p>
        `;
        finalStatusScreen.style.display='block';
      } finally {
        sendTicketBtn.disabled = false;
        sendingLoader.classList.remove('active');
      }
    });

    // Botão de pagamento Mercado Pago (antes de gerar)
    if(payMpBtn){
      payMpBtn.addEventListener('click', ()=>{
        playClick();
        const total = calcularTotalNumero();
        if(total === 0){ alert('Selecione ao menos 1 ingresso.'); return; }
        if(!linksPagamento[total]){ alert('Para este total não há link configurado. Ajuste as quantidades.'); return; }
        openPaymentLinkForTotal(total);
      });
    }

    // Delegação: abrir modal nas sessões e âncoras suaves
    document.body.addEventListener('click', (e)=>{
      const target = e.target.closest('a,button');
      if(!target) return;

      if(target.matches('.action-button, .nav-button, .event-button, .continue-button')) playClick();

      if(target.matches('.event-button') && target.dataset.sessionId){
        e.preventDefault();
        openModal(target.dataset.sessionId);
      }

      if(target.matches('a[href^="#"]')){
        const href = target.getAttribute('href');
        e.preventDefault();
        document.querySelector(href)?.scrollIntoView({behavior:'smooth', block:'start'});
      }
    });

    /***********************
     SCRAP
    ***********************/
    const scrapBtn = document.getElementById('scrap-button');
    const scrapInput = document.getElementById('scrap-input');
    const scrapLoading = document.getElementById('scrap-loading');
    const scrapResult = document.getElementById('scrap-result');
    const msnSound = new Audio("https://www.myinstants.com/media/sounds/msn_nudge.mp3");

const scrapsVariacoes = [
  () => "oiiiee - passaNdO só p/ dxa um scrap bunitinhu aki 😜💖",
  () => "vc é mto + q especial s2 num esqce d mim nãao 😭💌",
  () => "amg vrddr é aki 👉 [ ] … vc marcou mto em 2005 kkkk 😎",
  () => "buzz só p/ te lembrar q eu existo (L) kkkkkk",
  () => "add no msn: gatinha_loka2005@hotmail.com 🤭🔥",
  () => "seu depo é verdadeiro??? kkk apaga nãao 😍📸",
  () => "meu status: ocupadoo… mas só p/ vc eu fico disp ;)",
  () => "flw vlw bjs d glitter ✨🌈 me manda 1 gif tbm",
  () => "sdds d qnd a gnt ficava até 3 da manhã jogando colheita feliz kkk 🌽🐄",
  () => "se num mandar scrap, num é amigo d vrdd 😏🤟",
  () => "meu coraçãum é cm o Orkut: só p/ qm tem convite 🥰🔒",
  () => "xegaa no role q vai ser mtooo loko \\o/ 🕺💿",
  () => "se vc num me ligar d dscado hj a noite, fico mto xatiada 😤📞",
  () => "meu top 5 d depo ta fechadu só c/ qm é d vrdd s2"
];


    ];

    if(scrapBtn){
      scrapBtn.addEventListener('click', ()=>{
        const txt = (scrapInput.value||'').trim();
        if(!txt){ scrapResult.textContent = 'Escreva algo tipo “MSN”, “Orkut” ou “lan house”...'; return; }
        scrapLoading.classList.add('active');
        setTimeout(()=>{
          scrapLoading.classList.remove('active');
          const variation = scrapsVariacoes[Math.floor(Math.random()*scrapsVariacoes.length)];
          scrapResult.textContent = variation();
          try{ msnSound.currentTime = 0; msnSound.play(); }catch(e){}
        }, 700);
      });
    }

    /***********************
     INIT
    ***********************/
    function initialize(){
      createParticles();
      renderContent();
      updateCountdown();
      setInterval(updateCountdown, 1000);
    }
    initialize();
  </script>
</body>
</html>






